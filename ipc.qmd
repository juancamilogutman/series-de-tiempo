---
title: "2do Trabajo Práctico de Econometría"
author: "Max Murmis y Juan Camilo Gutman"
# pdf-engine: pdflatex
format: pdf
editor: visual
---

En el presente trabajo nos propusimos analizar la inflación...

## Carga y limpieza de la base de datos

Utilizamos las siguientes librerías:

```{r}
#| output: false

library(tidyverse) #Para manejar bases de datos
library(tsibble) #Para manejar bases para series de tiempo
library(fable) #Para correr modelos de series de tiempo
library(ggplot2) #Para graficar
library(knitr) #Para tablas
library(fpp3)
```

Utilizaremos una base del CEPED, disponible en su portal de estadísticas CEPED.data, en el siguiente enlace ceped-data.shinyapps.io/ceped-data/

```{r}
ipc <- readRDS("base_ipc.RDS")
```

```{r}

# Pequeña exploración
colnames(ipc)
unique(ipc$cod.variable)

# Para trabajar con valores mensuales, desde 2003:
ipc <- ipc %>%
  filter(cod.variable == "IPC_Mensual_2006") %>%
  filter(ANO4 >= 2003)

# Formato fechas:
ipc <- ipc %>%
  mutate(periodo = yearmonth(make_date(ANO4, sub)))

# Nos quedamos con las columnas de interés
ipc <- ipc %>% 
  select(c("periodo", "valor"))
```

En el Anexo (agregar link) se describe la construcción de dicha base empalmada. En @tbl-ceped puede verse el head del dataframe.

```{r}
#| label: tbl-ceped
#| tbl-cap: "Base CEPED.data"
#| echo: false

knitr::kable(head(ipc, 15))
#ver si agregar también el tail del dataframe y dónde está el 100
```

Para modelar la inflación mensual $(\pi_t)$ realizaremos el siguiente cómputo:

$$
\pi_t = ln(ipc_t) - ln(ipc_{t-1})
$$

```{r}
#| label: tbl-inflacion
#| tbl-cap: "Inflación 2003-2023"
#| echo: false

infl <- ipc %>% 
  mutate(ln_ipc = log(valor)) %>%
  mutate(inflacion = ln_ipc - lag(ln_ipc)) %>% 
  select(c("periodo", "inflacion"))

knitr::kable(head(infl, 15))
#ver si agregar también el tail del dataframe
```

Vamos a separar los últimos 6 meses para realizar pronóstico.

```{r}
infl <- infl %>% as_tsibble(index = periodo)
```

```{r}
# Simple gráfico de la evolución en el tiempo de la inflación
autoplot(infl, inflacion) +
  labs(title = "Inflación mensual ",
       subtitle = "2003-2023",
       y = "Inflación")
```

Gráfico de dispersión entre la inflación corriente y la del periodo inmediatamente anterior (esto es, si no me equivoco, un gráfico que ilustra la autocorrelación con un solo rezago:

```{r}
infl %>% gg_lag(
  inflacion, geom = "point", lags = 1) +
  labs(x = "lag(inflacion, k)")
```

```{r}
infl %>% gg_lag(
  inflacion, geom = "point", lags = 1:6) +
  labs(x = "lag(inflacion, k)")
```

ACF (autocorrelation function):

```{r}
infl %>% ACF(inflacion, lag_max = 9) %>% 
  knitr::kable()

```

Se observa fácil como decae la autocorrelación con cada mes que nos alejamos...

¿Decae exponencialmente?

```{r}
infl |>
  ACF(inflacion) |>
  autoplot() + labs(title= "Inflacion argentina 2003-2023",
                    subtitle= "Correlograma")
```
